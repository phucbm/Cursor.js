/*! For license information please see gsap-cursor.js.LICENSE.txt */
import gsap from"gsap";export class Cursor{constructor(t){return this.config={dev:!1,speed:1,className:"",style:{},hover:[],attraction:.2,distance:100,onChange:t=>{},...t},this.mouse={x:0,y:0},this.status={in:!1,hover:[],lastHover:""},this.style={default:{duration:.3,xPercent:-50,yPercent:-50,pointerEvents:"none",zIndex:"9999",position:"fixed",top:0,left:0,width:"15px",height:"15px",borderRadius:"50%",backgroundColor:"rgba(0, 0, 0, .5)",...this.config.style},out:{opacity:0,duration:.3},in:{opacity:1,duration:.3}},this.createCursor(),this.positionUpdate(),this.eventListener(),{setMousePosition:(t,s)=>this.setMousePosition(t,s),update:t=>this.update(t)}}createCursor(){const t=this.uniqueId("cursor-"),s=document.createElement("div");s.setAttribute("id",t),s.setAttribute("class",`custom-cursor ${this.config.className}`),document.body.appendChild(s),this.cursor=document.querySelector(`#${t}`),this.setCursorOut(),this.config.dev&&console.log(`cursor created #${t}`)}update(t){this.config={...this.config,...t},this.style.default={...this.style.default,...this.config.style},this.setCursorDefault()}setMousePosition(t,s){this.mouse.x=t,this.mouse.y=s,"function"==typeof this.config.onChange&&this.config.onChange({mouse:this.mouse})}positionUpdate(){const t={x:window.innerWidth/2,y:window.innerHeight/2};this.setMousePosition(t.x,t.y);const s=gsap.quickSetter(this.cursor,"x","px"),e=gsap.quickSetter(this.cursor,"y","px");gsap.ticker.add((()=>{if(this.isMagnetic){const s=this.getMagneticPosition(this.hoverTarget);t.x=s.x,t.y=s.y}else{const s=1-Math.pow(1-this.config.speed,gsap.ticker.deltaRatio());t.x+=(this.mouse.x-t.x)*s,t.y+=(this.mouse.y-t.y)*s}s(t.x),e(t.y)}))}eventListener(){document.addEventListener("mouseleave",(t=>{this.cursorOut(t)})),document.addEventListener("mouseenter",(t=>{this.cursorIn(t)})),window.addEventListener("mousemove",(t=>{this.cursorMoving(t)}));for(const t of this.config.hover)document.querySelectorAll(t.selector).forEach((s=>{s.style.cursor="none",s.addEventListener("mouseenter",(s=>{this.config.dev&&console.log(`hover in [${t.selector}]`),this.status.lastHover=this.status.hover[this.status.hover.length-1]||t.selector,this.status.hover.push(t.selector),this.setCursorHover(s)})),s.addEventListener("mouseleave",(s=>{this.config.dev&&console.log(`hover out [${t.selector}]`),this.status.hover=this.status.hover.filter((s=>s!==t.selector)),this.setCursorHover(s)}))}))}cursorIn(t){this.config.dev&&console.log("doc in"),this.status.in=!0,this.setCursorDefault(),this.setCursorIn()}cursorOut(t){this.config.dev&&console.log("doc out"),this.status.in=!1,this.setCursorDefault(),this.setCursorOut()}cursorMoving(t){this.setMousePosition(t.x,t.y),this.isEnterStyleDrawn()||this.status.hover.length||this.cursorIn(t),this.status.hover.length&&this.hoverTarget&&this.setCursorHover(this.hoverTarget)}setCursorHover(t){const s=this.status.hover[this.status.hover.length-1];if(void 0!==s){const e=this.getHover(s);this.hoverTarget=t.target||this.hoverTarget,"function"==typeof e.in&&e.in(this),"object"==typeof e.in&&this.setCursorStyle(e.in),this.isMagnetic="boolean"==typeof e.magnetic&&e.magnetic}else{if(void 0!==this.status.lastHover){const t=this.getHover(this.status.lastHover);"function"==typeof t.out&&t.out(this),"object"==typeof t.out&&this.setCursorStyle(t.out)}this.cursorIn(t),this.isMagnetic=!1}}setCursorStyle(t){gsap.to(this.cursor,{duration:.2,...t})}setCursorIn(){this.config.dev&&console.log("gsap in"),this.setCursorStyle(this.style.in)}setCursorOut(){this.config.dev&&console.log("gsap out"),this.setCursorStyle(this.style.out)}setCursorDefault(){this.config.dev&&console.log("gsap default"),this.setCursorStyle(this.style.default)}isEnterStyleDrawn(){return this.cursor.style.width===this.style.default.width&&this.cursor.style.height===this.style.default.height}getHover(t){for(const s of this.config.hover)if(s.selector===t)return s;return!1}uniqueId(t=""){return t+(+new Date).toString(16)+(1e8*Math.random()|0).toString(16)}getOffset(t=this.cursor){if(!t.getClientRects().length)return{top:0,left:0};const s=t.getBoundingClientRect(),e=t.ownerDocument.defaultView;return{top:s.top+e.pageYOffset,left:s.left+e.pageXOffset}}distanceFromMouseToEl(t,s=this.mouse.x,e=this.mouse.y){let o=s-(this.getOffset(t).left+t.offsetWidth/2),i=e-(this.getOffset(t).top+t.offsetHeight/2),r=Math.sqrt(Math.pow(o,2)+Math.pow(i,2));return Math.floor(r)}getMagneticPosition(t){if(void 0===t)return this.mouse;const s=this.getOffset(t).left+t.offsetWidth/2,e=this.getOffset(t).top+t.offsetHeight/2,o=-1*Math.floor(s-this.mouse.x)*this.config.attraction,i=-1*Math.floor(e-this.mouse.y)*this.config.attraction;return this.distanceFromMouseToEl(t)<this.config.distance?{x:o+s,y:i+e}:this.mouse}}